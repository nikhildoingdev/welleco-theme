{% comment %} /sections/featured-articles.liquid {% endcomment %}

{{ 'swiper7.4.1.min.css' | asset_url | stylesheet_tag }}
{{ 'section-featured-articles.css' | asset_url | stylesheet_tag }}
<script src="{{ "swiper7.4.1.min.js" | asset_url }}" defer="defer" id="swiper-script"></script>
<script src="{{ 'section-featured-articles.js' | asset_url }}" type="module"></script>

{%- liquid
  assign heading = section.settings.heading
  assign heading_italic = section.settings.heading_italic
  assign description = section.settings.description
  assign button_text = section.settings.button_text
  assign button_url = section.settings.button_url
  assign articles_to_show = section.blocks.size
-%}

{%- if articles_to_show > 0 -%}
  <featured-articles data-section-id="{{ section.id }}" class="featured-articles-section">
    <div class="page-width featured-articles-content">
      <div class="featured-articles__header">
        {%- if heading != blank or heading_italic != blank -%}
          <h2 class="featured-articles__heading">
            {%- if heading != blank -%}{{ heading | escape }}{%- endif -%}
            {%- if heading_italic != blank -%}
              <em class="featured-articles__heading-italic">{{ heading_italic | escape }}</em>
            {%- endif -%}
          </h2>
        {%- endif -%}
        {%- if description != blank -%}
          <p class="featured-articles__description">{{ description }}</p>
        {%- endif -%}
      </div>

      <div id="featured-articles-{{ section.id }}" class="featured-articles__swiper swiper">
        <div class="featured-articles__swiper-arrows">
          <div class="swiper-button-prev featured-articles__swiper-prev">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">
              <path d="M14.5 6.00005L1.5 6.00005M1.5 6.00005L6.375 0.800049M1.5 6.00005L6.375 11.2" stroke="#9D9D9D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="swiper-button-next featured-articles__swiper-next">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none">
              <path d="M1.5 6.00005L14.5 6.00005M14.5 6.00005L9.625 0.800049M14.5 6.00005L9.625 11.2" stroke="#9D9D9D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
        <div class="swiper-wrapper">
          {%- for block in section.blocks -%}
            {%- assign article = block.settings.article -%}
            {%- assign custom_image = block.settings.custom_image -%}
            {%- assign category = block.settings.category -%}
            {%- assign headline = block.settings.headline -%}
            {%- assign article_url = block.settings.article_url -%}

            <div class="featured-articles__card swiper-slide" {{ block.shopify_attributes }}>
              <article class="article-card">
                <a href="{{ article_url | default: article.url }}" class="article-card__link">
                  <div class="article-card__image-wrapper">
                    {%- if custom_image != blank -%}
                      <img
                        srcset="
                          {%- if custom_image.width >= 300 -%}{{ custom_image | image_url: width: 300 }} 300w,{%- endif -%}
                          {%- if custom_image.width >= 500 -%}{{ custom_image | image_url: width: 500 }} 500w,{%- endif -%}
                          {{ custom_image | image_url }} {{ custom_image.width }}w
                        "
                        src="{{ custom_image | image_url: width: 500 }}"
                        sizes="(min-width: 990px) 25vw, 50vw"
                        alt="{{ custom_image.alt | default: headline | escape }}"
                        loading="lazy"
                        width="{{ custom_image.width }}"
                        height="{{ custom_image.height }}"
                        class="article-card__image"
                      >
                    {%- elsif article.image != blank -%}
                      <img
                        srcset="
                          {%- if article.image.width >= 300 -%}{{ article.image | image_url: width: 300 }} 300w,{%- endif -%}
                          {%- if article.image.width >= 500 -%}{{ article.image | image_url: width: 500 }} 500w,{%- endif -%}
                          {{ article.image | image_url }} {{ article.image.width }}w
                        "
                        src="{{ article.image | image_url: width: 500 }}"
                        sizes="(min-width: 990px) 25vw, 50vw"
                        alt="{{ article.image.alt | default: article.title | escape }}"
                        loading="lazy"
                        width="{{ article.image.width }}"
                        height="{{ article.image.height }}"
                        class="article-card__image"
                      >
                    {%- else -%}
                      <div class="article-card__placeholder">
                        {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
                      </div>
                    {%- endif -%}
                  </div>

                  <div class="article-card__content">
                    {%- if category != blank -%}
                      <span class="article-card__category">{{ category | escape }}</span>
                    {%- endif -%}
                    <h3 class="article-card__title">{{ headline | default: article.title | escape }}</h3>
                    <span class="article-card__view-link">View</span>
                  </div>
                </a>
              </article>
            </div>
          {%- endfor -%}
        </div>
      </div>

      {%- if button_text != blank and button_url != blank -%}
        <div class="featured-articles__button-wrapper">
          <a href="{{ button_url }}" class="featured-articles__button">
            {{ button_text | escape }}
          </a>
        </div>
      {%- endif -%}
    </div>
  </featured-articles>
{%- endif -%}

{% schema %}
{
  "name": "Featured Articles",
  "tag": "section",
  "class": "featured-articles",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "The"
    },
    {
      "type": "text",
      "id": "heading_italic",
      "label": "Heading Italic",
      "default": "JOURNAL"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Supporting description text with bold or italic for emphasis."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "EXPLORE MORE"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "article_card",
      "name": "Article Card",
      "settings": [
        {
          "type": "article",
          "id": "article",
          "label": "Article (optional)"
        },
        {
          "type": "image_picker",
          "id": "custom_image",
          "label": "Custom Image"
        },
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "BLOG CATEGORY"
        },
        {
          "type": "textarea",
          "id": "headline",
          "label": "Headline",
          "default": "Read the headline of a journal article over two or three lines of text if required."
        },
        {
          "type": "url",
          "id": "article_url",
          "label": "Article URL"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Articles",
      "blocks": [
        { "type": "article_card" },
        { "type": "article_card" },
        { "type": "article_card" },
        { "type": "article_card" }
      ]
    }
  ]
}
{% endschema %}
