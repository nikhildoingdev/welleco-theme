{% comment %}
  Brand Discovery Section
  Displays a collage of images with optional text overlays, followed by brand messaging and a CTA button.
{% endcomment %}

{{ 'section-brand-discovery.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign heading = section.settings.heading
  assign description = section.settings.description
  assign button_text = section.settings.button_text
  assign button_link = section.settings.button_link

  assign background_color = section.settings.background_color
  assign text_color = section.settings.text_color
  assign heading_color = section.settings.heading_color
  assign button_background_color = section.settings.button_background_color
  assign button_text_color = section.settings.button_text_color

  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign image_gap = section.settings.image_gap
  assign content_alignment = section.settings.content_alignment

  assign images_count = section.blocks.size
-%}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ padding_top }}px;
      padding-bottom: {{ padding_bottom }}px;
    }
  }
{%- endstyle -%}

<div
  class="brand-discovery section-{{ section.id }}-padding"
  data-section="{{ section.id }}"
  style="
    --brand-discovery-bg-color: {{ background_color }};
    --brand-discovery-text-color: {{ text_color }};
    --brand-discovery-heading-color: {{ heading_color }};
    --brand-discovery-button-bg: {{ button_background_color }};
    --brand-discovery-button-text: {{ button_text_color }};
    --brand-discovery-image-gap: {{ image_gap }}px;
    --brand-discovery-content-alignment: {{ content_alignment }};
  "
>
  {%- if images_count > 0 -%}
    <div class="brand-discovery__images">
      {%- for block in section.blocks -%}
        {%- assign image = block.settings.image -%}
        {%- assign overlay_text = block.settings.overlay_text -%}
        {%- assign text_position = block.settings.text_position -%}
        {%- assign image_filter = block.settings.image_filter -%}
        {%- assign text_color_block = block.settings.text_color -%}
        {%- assign text_size = block.settings.text_size -%}

        <div
          class="brand-discovery__image-block brand-discovery__image-block--{{ image_filter }}"
          {{ block.shopify_attributes }}
          style="
            --brand-discovery-block-text-color: {{ text_color_block }};
            --brand-discovery-block-text-size: {{ text_size }}px;
          "
        >
          {%- if image != blank -%}
            <div class="brand-discovery__image-wrapper">
              {{
                image
                | image_url: width: 1200
                | image_tag: loading: 'lazy', widths: '300, 600, 900, 1200', class: 'brand-discovery__image'
              }}
              {%- if overlay_text != blank -%}
                <div class="brand-discovery__overlay-text brand-discovery__overlay-text--{{ text_position }}">
                  {{ overlay_text | escape }}
                </div>
              {%- endif -%}
            </div>
          {%- else -%}
            <div class="brand-discovery__image-wrapper brand-discovery__image-wrapper--placeholder">
              {{ 'image' | placeholder_svg_tag: 'brand-discovery__placeholder' }}
            </div>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>
  {%- endif -%}

  <div class="brand-discovery__content page-width">
    {%- if heading != blank -%}
      <h2 class="brand-discovery__heading">{{ heading | escape }}</h2>
    {%- endif -%}

    {%- if description != blank -%}
      <p class="brand-discovery__description">{{ description | escape }}</p>
    {%- endif -%}

    {%- if button_text != blank and button_link != blank -%}
      <a href="{{ button_link }}" class="brand-discovery__button button">
        {{ button_text | escape }}
      </a>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Brand Discovery",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "THE PIONEER OF INGESTIBLE BEAUTY SINCE 2014"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "WelleCo is committed to empowering you to own your wellness journey. Naturally."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "ABOUT"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Content Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Color Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#F5F5F0"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Button Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text Color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "range",
      "id": "image_gap",
      "label": "Image Gap",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top Padding",
      "default": 56
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 56
    }
  ],
  "blocks": [
    {
      "type": "image_block",
      "name": "Image Block",
      "limit": 4,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "overlay_text",
          "label": "Overlay Text",
          "info": "Optional text to display over the image"
        },
        {
          "type": "select",
          "id": "text_position",
          "label": "Text Position",
          "options": [
            { "value": "top-left", "label": "Top Left" },
            { "value": "top-right", "label": "Top Right" },
            { "value": "center-left", "label": "Center Left" },
            { "value": "center", "label": "Center" },
            { "value": "center-right", "label": "Center Right" },
            { "value": "bottom-left", "label": "Bottom Left" },
            { "value": "bottom-right", "label": "Bottom Right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "image_filter",
          "label": "Image Filter",
          "options": [
            { "value": "color", "label": "Color" },
            { "value": "grayscale", "label": "Grayscale" }
          ],
          "default": "color"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#FFFFFF"
        },
        {
          "type": "range",
          "id": "text_size",
          "label": "Text Size",
          "min": 12,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 16
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Brand Discovery",
      "blocks": [
        { "type": "image_block" },
        { "type": "image_block" },
        { "type": "image_block" },
        { "type": "image_block" }
      ]
    }
  ]
}
{% endschema %}
